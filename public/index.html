<!DOCTYPE html>
<html lang="en">
<head>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
    <script lang="text/javascript" src="/socket.io/socket.io.js"></script>
    <script src="/simple-peer/simplepeer.min.js"></script>
</head>
<body>
    <div class="container">
        <h2>
            <small>Your peer id is: </small> <span id="myId"></span>
        </h2>
        <div class="row">
            <div class="col-4" id="peers">
                <h4>Peers Available</h4>
            </div>
            <div class="col-8">
                <h4>Send Message</h4>
                <form id="connect">
                    <div class="form-group">
                        <label>Send to: </label>
                        <input type="text" class="form-control" id="sendTo" />
                    </div>
                    <div class="form-group">
                        <label>Message: </label>
                        <textarea class="form-control" id="message"></textarea>
                    </div>
                    <hr />
                    <button class="btn btn-primary" type="button" id="send">
                        Send
                    </button>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="col-12">
                <h4>Messages</h4>
                <div id="messages">

                </div>
            </div>
        </div>

    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.min.js" integrity="sha512-XKa9Hemdy1Ui3KSGgJdgMyYlUg1gM+QhL6cnlyTe2qzMCYm4nAZ1PsVerQzTTXzonUR+dmswHqgJPuwCq1MaAg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="../webRTCStuff.js"></script>
    <script>
        $(function () {
            //init();
            $("#send").on("click", function (ev) {
                ev.preventDefault();
                const socket_id = $("#sendTo").val();
                const message = $("#message").val();
                if (peers[socket_id] && message.length) {
                    peers[socket_id].send(message)
                    $("#message").val("");
                    $("#messages").prepend($("<p>", { text: "you said: " + message + " to " + socket_id }))
                }

            })
            $("body").on("click", ".peerLink.connected", function (ev) {
                ev.preventDefault();
                $("#sendTo").val($(this).attr("data-socket_Id"));
            })
        })
        
        /*function connectToPeer(peer_Id){
            /***This will try to connect to peer and if connection is successful peerConnected will be fired***/
            /***If no reply or peerError is triggered then peer cannot connect for some reason***/
        }*/
        
        function peerConnected(peer_Id){
            /***Peer was connected with WebRtc Successfully***/
        }
        
        function peerError(peer_Id, data){
            /***Error connecting to peer use this to handle connection error**/
        }
        
        function peerData(peer_Id, data){
            /***Connected Peer sent data use data as required***/
            /***Peer Id is the sender***/
        }
        
        function sendData(peer_Id, data){
            /***Use this section to send data to connected peer***/
            /***Peer Id is the reciever***/
            if(peers[peer_Id].length){
               /***Peer Exist Send Data***/
              //peers[peer_Id].send(data)
            }
            else{
                /***If this section then peer has disconnected or error***/
            }
        }
        
    </script>
</body>
</html>
